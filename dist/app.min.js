"use strict";angular.module("dictionary",[]),angular.module("category",["ngResource","routines","uiDeniModalMdl"]),function(){angular.module("expression",[])}(),angular.module("item",["ngResource","text","video","expression","pronunciation","dictionary","routines","uiDeniModalMdl"]),angular.module("pronunciation",[]),angular.module("routines",[]),angular.module("text",[]),angular.module("video",[]),angular.module("app",["ngRoute","text","video","ngMaterial","ngResource","ngMessages","ngSanitize","material.svgAssetsCache","ui-deni-grid","uiDeniModalMdl","expression","dictionary","pronunciation","category","item","routines","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","info.vietnamcode.nampnq.videogular.plugins.youtube","summernote","ngFileUpload"]),angular.module("app").config(function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/)}),function(){angular.module("dictionary").constant("dictionaryModalEnums",{SearchState:{STOPPED:0,SEARCHING:1,SEARCHED:2,ADDING:3,ADDED:4}})}(),function(){angular.module("pronunciation").constant("pronunciationModalEnums",{SearchState:{STOPPED:0,SEARCHING:1,SEARCHED:2,ADDING:3,ADDED:4}})}(),function(){function e(e,t){function n(n){var i=e.defer(),o=this;return n||0===o.cachedExpressions.length?t.requestWithPromise("dictionary/list").then(function(e){o.cachedExpressions=e.data.data,i.resolve(o.cachedExpressions)}):i.resolve(o.cachedExpressions),i.promise}function i(e,n){var i={title:"Inserting",message:"Expression added successfully!"};return t.requestWithPromise("dictionary/add",{ds_expressao:e,ds_tags:n},i)}function o(e,n,i){var o={title:"Updating",message:"Expression updated successfully!"};return t.requestWithPromise("dictionary/upd",{cd_dicionario:e,ds_expressao:n,ds_tags:i},o)}function r(e){var n={title:"Deleting",message:"Expression deleted successfully!"};return t.requestWithPromise("dictionary/del",{cd_dicionario:e},n,"Confirm deleting?")}function a(e){var n={title:"Updating",message:"Expression updated successfully!"};return t.requestWithPromise("dictionary/learned/toogle",{cd_dicionario:e},n)}function s(e,n){var i={title:"Updating",message:"Expression updated successfully!"};return t.requestWithPromisePayLoad("dictionary/definition/set",{},{cd_dicionario:e,tx_definicao:n},i)}function c(e){return t.requestWithPromise("dictionary/definition/get",{cd_dicionario:e})}return{cachedExpressions:[],list:n,add:i,upd:o,del:r,learnedToogle:a,definitionSet:s,definitionGet:c}}angular.module("dictionary").factory("dictionaryDataService",e)}(),function(){function e(e,t,n,i,o){var r=this;r.list=function(){return t.list()},r.add=function(e,n){return t.add(e,n)},r.del=function(e){return t.del(e)},r.learnedToogle=function(e){return t.learnedToogle(e)},r.definitionSet=function(e,n){return t.definitionSet(e,n)},r.definitionGet=function(n){var i=e.defer();return t.definitionGet(n).then(function(e){i.resolve(e.data.data[0].txDefinicao)}),i.promise},r.openDictionaryDefinitionView=function(e,t,n){event.ctrlKey?o.listenExpression(n):i.createWindow({scope:e,title:"Dictionary - "+n,width:"800px",height:"500px",position:i.POSITION.CENTER,buttons:[i.BUTTON.OK],htmlTemplate:'<dictionary-definition-viewer cd-dicionario="'+t+'"></dictionary-definition-viewer>',modal:!0}).show()}}angular.module("dictionary").service("dictionaryService",e)}(),function(){function e(e){function t(t,n){var i={title:"Adding",message:"Category added successfully!"};return e.requestWithPromise("category/add",{cd_categoria_pai:t,ds_categoria:n},i)}function n(t,n){var i={title:"Editing",message:"Category renamed successfully!"};return e.requestWithPromise("category/upd",{cd_categoria:t,ds_categoria:n},i)}function i(t){var n={title:"Deleting",message:"Category deleted successfully!"};return e.requestWithPromise("category/del",{cd_categoria:t},n,"Confirm deleting?")}return{add:t,rename:n,del:i}}angular.module("category").factory("categoryDataService",e)}(),function(){function e(e,t,n){var i=this;i.add=function(i,o){var r=e.defer();return n.prompt("New Category","Enter a descrption of the category","",!0,i).then(function(e){t.add(o,e).then(function(e){r.resolve(e.data.data[0])})}),r.promise},i.rename=function(i,o,r){var a=e.defer();return n.prompt("Renaming Category","Enter a descrption of the category",r,!0,i).then(function(e){t.rename(o,e).then(function(e){a.resolve(e.data.data[0].dsCategoria)})}),a.promise},i.del=function(n){var i=e.defer();return t.del(n).then(function(e){i.resolve(e.data.data[0])}),i.promise}}angular.module("category").service("categoryService",e)}(),function(){function e(){var e=this;e.loadedExpressions=[]}angular.module("expression").service("expressionService",e)}(),function(){function e(e){function t(t){return e.requestWithPromise("item/list",{cd_categoria:t})}function n(t){return e.requestWithPromise("item/get",{cd_item:t})}function i(t,n,i,o){var r={title:"Inserting",message:"Item added successfully!"};return e.requestWithPromisePayLoad("item/add",{topCategoryNode:t,cd_categoria:n,ds_item:i},{bt_imagem:o},r)}function o(t,n,i,o){var r={title:"Updating",message:"Item updated successfully!"};return e.requestWithPromisePayLoad("item/upd",{cd_item:t,cd_categoria:n,ds_item:i},{bt_imagem:o},r)}function r(t){var n={title:"Deleting",message:"Item deleted successfully!"};return e.requestWithPromise("item/del",{cd_item:t},n,"Confirm deleting?")}function a(t,n){return e.requestWithPromise("item/favorite/set",{cd_item:t,bl_favorite:n})}function s(t){return e.requestWithPromise("item/favorite/get",{cd_item:t})}function c(t,n){return e.requestWithPromise("item/revision/set",{cd_item:t,bl_fazer_revisao:n})}function l(t){return e.requestWithPromise("item/revision/get",{cd_item:t})}return{list:t,get:n,add:i,upd:o,del:r,favorite:{set:a,get:s},revision:{set:c,get:l}}}angular.module("item").factory("itemDataService",e)}(),function(){function e(e,t,n,i,o,r,a,s,c){var l=this,d=function(e,r){var a=t.defer(),s=o.createWindowDescriptionMoreImage();return s.show().then(function(e){if("ok"==e.button){var t=i.getDataURLImagemObjeto(e.data.imageEl.get(0),150,150,.5);n.add(c.topParentNodeId,r,e.data.description,t).then(function(e){a.resolve(e)})}else a.reject()}),a.promise},u=function(n,i){var o=t.defer();return n.newVideoItemModal={canShowImagePreview:!1,tp_video:0},n.newVideoItemModal.getImagePreviewUrl=function(){return n.newVideoItemModal.canShowImagePreview=n.newVideoItemModal.id_video&&(0==n.newVideoItemModal.tp_video&&11==n.newVideoItemModal.id_video.length||1==n.newVideoItemModal.tp_video&&28==n.newVideoItemModal.id_video.length),n.newVideoItemModal.canShowImagePreview?s.SERVER_URL+"item/image/getlink?tp_video="+n.newVideoItemModal.tp_video+"&id_video="+n.newVideoItemModal.id_video:null},r.showModal(n).then(function(t){e.loading=!0,a.add(i,n.newVideoItemModal.tp_video,n.newVideoItemModal.id_video,n.newVideoItemModal.description).then(function(t){o.resolve(t),e.loading=!1})}),o.promise};l.add=function(e,t,n){return t==c.topParentNodeId?d(e,n):u(e,n)},l.del=function(e){return n.del(e)},l.favorite={set:function(e,i){var o=t.defer();return n.favorite.set(e,i).then(function(e){o.resolve(e.data.data[0].blFavorite)},function(e){o.reject(e)}),o.promise},get:function(e){var i=t.defer();return n.favorite.get(e).then(function(e){i.resolve(e.data.data[0].blFavorite)},function(e){i.reject(e)}),i.promise}},l.revision={set:function(e,i){var o=t.defer();return n.revision.set(e,i).then(function(e){o.resolve(e.data.data[0].blFazerRevisao)},function(e){o.reject(e)}),o.promise},get:function(e){var i=t.defer();return n.revision.get(e).then(function(e){i.resolve(e.data.data[0].blFazerRevisao)},function(e){i.reject(e)}),i.promise}}}angular.module("item").service("itemService",e)}(),function(){function e(e,t){var n=this;n.loadedExpressions=[],n.list=function(){var i=e.defer();return t.requestWithPromise("pronunciation/list").then(function(e){n.loadedExpressions=e.data.data,i.resolve(n.loadedExpressions)}),i.promise},n.add=function(e){var n={title:"Inserting",message:"Expression added successfully!"};return t.requestWithPromise("pronunciation/add",{ds_expressao:e},n)},n.del=function(e){var n={title:"Deleting",message:"Expression deleted successfully!"};return t.requestWithPromise("pronunciation/del",{cd_pronuncia:e},n,"Confirm deleting?")},n.learnedToogle=function(e){var n={title:"Updating",message:"Expression updated successfully!"};return t.requestWithPromise("pronunciation/learned/toogle",{cd_pronuncia:e},n)}}angular.module("pronunciation").service("pronunciationRestService",e)}(),function(){function e(e,t){this.listenExpression=function(n){var i=e.defer();try{if(event.ctrlKey&&event.shiftKey){var o="http://www.wordreference.com/enpt/";t.open(o+n)}else var r=setInterval(function(){var e=speechSynthesis.getVoices();if(0!==e.length){clearInterval(r);var t=new SpeechSynthesisUtterance;t.text=n,t.lang="en-US";for(var o=0;o<e.length;o++)if(e[o].lang==t.lang){t.voice=e[o];break}t.rate=.8,t.onstart=function(e){},t.onend=function(e){i.resolve()},speechSynthesis.speak(t)}},200)}catch(a){i.reject(a)}return i.promise}}angular.module("pronunciation").service("pronunciationService",e)}(),function(){function e(e){var t=this;t.getItemInfo=function(t){return e.requestWithPromise("revision/item/info",{cd_item:t})},t.getExpressions=function(t,n){return e.requestWithPromise("revision/expressions/get",{cd_item:t,onlyVisible:n})},t.updExpressions=function(t,n){var i={title:"Spaced Revision",message:"expressions updated succesfully!"};return e.requestWithPromisePayLoad("revision/expressions/upd",{cd_item:t},n,i)},t.updText=function(t,n){var i={title:"Spaced Revision",message:"expressions updated succesfully!"};return e.requestWithPromise("revision/expressions/updtext",{cd_item:t,returnOnlyVisible:n},i)},t.markAsReviewed=function(t){return e.requestWithPromise("revision/markasreviewed",{cd_item:t})}}angular.module("app").service("revisionRestService",e)}(),function(){function e(e,t){var n=this;n.getItemInfo=function(n){var i=e.defer();return t.getItemInfo(n).then(function(e){var t=e.data.data[0];i.resolve(t)},function(e){i.reject(e)}),i.promise},n.getExpressions=function(n,i){var o=e.defer();return t.getExpressions(n,i).then(function(e){var t=e.data.data;o.resolve(t)},function(e){o.reject(e)}),o.promise}}angular.module("app").service("revisionService",e)}(),function(){function e(e,t,n,i,o,r,a,s,c){var l=this;l.controller;var d=null;l.setController=function(e){l.controller=e},l.showModal=function(e){var n=t.defer();return i.createWindow({scope:e,title:"Dictionary",width:"700px",height:"580px",position:i.POSITION.CENTER,buttons:[i.BUTTON.CLOSE],urlTemplate:"src/app/shared/dictionary/dictionary-modal/dictionary-modal.view.html",modal:!0,listeners:{onshow:function(e){}}}).show().then(function(){c.loadedExpressions=s.loadedExpressions.concat(l.controller.gridDictionaryOptions.alldata),n.resolve(l.controller.gridDictionaryOptions.alldata)}),n.promise};var u=function(t){a.showModal(e,t).then(function(e){t.dsExpressao=e.dsExpression,t.dsTags=e.dsTags;var n=l.controller.gridDictionaryOptions.api.getSelectedRowIndex();l.controller.gridDictionaryOptions.api.repaintSelectedRow(),l.controller.gridDictionaryOptions.api.selectRow(n)})};l.getGridDictionaryOptions=function(){return{keyField:"cdDicionario",rowHeight:"25px",data:r.cachedExpressions,hideHeaders:!0,columns:[{name:"dsExpressao",width:"40%"},{name:"dsTags",width:"40%"},{width:"10%",action:{mdIcon:"edit",tooltip:"Edit the current expression",fn:function(e,t,n){u(e)}}},{width:"10%",action:{mdIcon:"delete_forever",tooltip:"Remove a expression from dictionary",fn:function(e,t,n){r.del(e.cdDicionario).then(function(t){var n=function(t){for(var n=t.length-1;n>=0;n--)if(t[n].cdDicionario==e.cdDicionario){t.splice(n,1);break}};n(l.controller.gridDictionaryOptions.data),n(l.controller.gridDictionaryOptions.alldata),l.controller.gridDictionaryOptions.api.loadData(l.controller.gridDictionaryOptions.alldata)})}}}],listeners:{onselectionchange:function(e,t,n,i){var o=$(".dictionary-modal .dictionary-definition-viewer"),t=angular.element(o),r=t.scope();r.$$childTail.ctrl.cdDicionario=i.cdDicionario,r.$$phase||r.$apply()},onbeforeload:function(){var e=$(".dictionary-modal .dictionary-definition-viewer"),t=angular.element(e),n=t.scope();n.$$childTail.ctrl.cdDicionario=null},onafterload:function(e,t){d&&(t.api.selectRow(d),d=null)},onrowdblclick:function(e,t,n){u(e)}}}},l.searchInputChange=function(){l.controller.searchState=o.SearchState.SEARCHING},l.searchInputKeydown=function(){13==event.keyCode&&(l.controller.searchState==o.SearchState.SEARCHING?l.searchButtonClick(l.controller):l.controller.searchState==o.SearchState.SEARCHED&&l.searchButtonAddClick())},l.showSearchButton=function(e){return"search"==e&&l.controller.searchState==o.SearchState.SEARCHING||"add"==e&&l.controller.searchState==o.SearchState.SEARCHED},l.searchButtonClick=function(){l.controller.searchState=o.SearchState.SEARCHED;var e=$(".dictionary-modal .search-input");l.controller.gridDictionaryOptions.api.filter(e.val())},l.searchButtonAddClick=function(){l.controller.searchState=o.SearchState.ADDED;var e=$(".dictionary-modal .search-input"),t=e.val();r.add(t,"").then(function(e){d=e.data.data[0];var t=function(e){for(var t=e.length,n=e.length-1;n>=0;n--)if(d.dsExpressao>e[n].dsExpressao){t=n;break}e.splice(t,0,d)};t(l.controller.gridDictionaryOptions.data),t(l.controller.gridDictionaryOptions.alldata),l.controller.gridDictionaryOptions.api.loadData(l.controller.gridDictionaryOptions.alldata),l.controller.searchState=o.SearchState.STOPPED})},l.showLoading=function(){return l.controller.searchState==o.SearchState.ADDED}}angular.module("dictionary").service("dictionaryModalService",e)}(),function(){function e(e,t,n,i,o,r){var a=this;a.SideEnum={LEFT:1,RIGHT:2},a.getAllExpressions=function(){var t=e.defer();return i.list(!0).then(function(e){o.list().then(function(n){r.loadedExpressions=e.concat(n),t.resolve(r.loadedExpressions)},function(e){console.error(e)})},function(e){console.error(e)}),t.promise},a.createHamburgerButton=function(e,t){var n=$(document.createElement("button"));n.addClass("md-button"),n.addClass("md-icon-button"),n.addClass("md-ink-ripple");for(var i=0;i<e.length;i++){var o=e[i];n.attr(o,""),n.addClass(o)}var r=$(document.createElement("img"));r.attr("src","src/assets/images/hamburger.png"),r.addClass("hamburger-button"),n.append(r);var s=$(".md-toolbar-tools-main");t===a.SideEnum.LEFT?s.prepend(n):s.append(n)},a.insertHtmlWithController=function(e,t,i,o){e.html("");var r=$("<div>"+t+"</div>");n(r)(o),e.append(r)},a.getDataURLImagemObjeto=function(e,t,n,i){var o=0,r=0;e instanceof HTMLImageElement?(o=e.naturalWidth,r=e.naturalHeight):(o=e.videoWidth,r=e.videoHeight);var a=document.createElement("canvas"),s=t,c=n,l=1;r>o?(l=s/o,c=l*r):(l=c/r,s=l*o),a.width=s,a.height=c;var d=a.getContext("2d");return d.drawImage(e,0,0,o,r,0,0,s,c),a.toDataURL("image/png",i)},a.getConfigWYSIWYG=function(e,t){var n=function(){var t=$.summernote.ui,n=t.button({contents:'<i class="glyphicon glyphicon-floppy-save"/>',tooltip:"save changes",click:function(){e()}});return n.render()},i=function(){var e=$.summernote.ui,n=e.button({contents:'<i class="glyphicon glyphicon-remove"/>',tooltip:"cancel changes",click:function(){t()}});return n.render()};return{disableDragAndDrop:!0,toolbar:[["saveOrCancelButtons",["saveButton","cancelButton"]],["fontsize",["fontname","fontsize","color"]],["style",["bold","italic","underline","clear"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]]],buttons:{saveButton:n,cancelButton:i}}}}angular.module("routines").service("generalService",e)}(),function(){function e(e,t,n,i){var o=this;o.SERVER_URL="https://denienglishsrv-denimar.rhcloud.com/",o.requestWithPromise=function(t,r,a,s){var c=e.defer(),l=function(){var e={params:r};n.get(o.SERVER_URL+t,e).then(function(e){if(!e.data.success)throw e.data.message;a&&i.ghost(a.title,a.message),c.resolve(e)})["catch"](function(e){e.data.message?i.error(e.data.message):i.error(e.data),c.reject(e)})};try{angular.module("ngRoute")}catch(d){a=null,s=null}return s?i.confirm(s).then(function(e){"yes"===e.button&&l()}):l(),c.promise},o.requestWithPromisePayLoad=function(n,r,a,s,c){var l=e.defer(),d=function(){var e=t(o.SERVER_URL+n,r,{},{request:{method:"POST"}});e.save(a).$promise.then(function(e){e.success?(s&&i.ghost(s.title,s.message),l.resolve(e)):(i.error(e.message),l.reject(e))})["catch"](function(e){e.message?i.error(e.message):e.data?e.data.message?i.error(e.data.message):i.error(e.data):i.error("Inespected Error!"),l.reject(e)})};return c?i.confirm(c).then(function(e){"yes"===e.button&&d()}):d(),l.promise}}angular.module("routines").service("restService",e)}(),function(){function e(e){var t=this;t.format=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=new RegExp("\\{"+(t-1).toString()+"\\}","gi");e=e.replace(n,arguments[t])}return e},t.leftPad=function(e,t,n){var i=t-e.toString().length+1;return Array(+(i>0&&i)).join(n)+e},t.replaceAll=function(e,t,n){return e?e.replace(RegExp("\\b"+t+"\\b","g"),n):""},t.doubleToStrTime=function(e){var n=3600,i=60,o=e/n,r=t.leftPad(Math.floor(o),2,"0"),a=e/i,s=t.leftPad(Math.floor(a),2,"0"),c=(e%i).toString(),l="000",d=c.indexOf(".");return d!=-1&&(l=c.substring(d+1).substring(0,3),l+="0".repeat(3-l.length),c=c.substring(0,d)),c=t.leftPad(Math.floor(c),2,"0")+","+l,r+":"+s+":"+c},t.strTimeToDouble=function(e){var t=e,n=parseInt(t.substring(0,2)),i=parseInt(t.substring(3,5));t=t.substring(6,t.length).replace(",",".");var o=parseFloat(t);return 3600*n+60*i+o},t.addLinksDictionaryAndPronunciation=function(n){if(0==e.loadedExpressions.length)return n;for(var i=e.loadedExpressions.sort(function(e,t){return t.dsExpressao.length-e.dsExpressao.length}),o=t.replaceAll(n,'"',"'"),r=o.toLowerCase(),a="matrizsubst1-{0}-matrizsubst2",s=[],c=0,l=0;l<i.length;l++){var d=i[l],u=[];if(u.push(d.dsExpressao.toLowerCase()),d.dsTags){var p=d.dsTags.split(",");angular.forEach(p,function(e){u.push(e.trim().toLowerCase())})}angular.forEach(u,function(e){for(var n=r.search(new RegExp("\\b"+e+"\\b"));n!=-1;){var i=o.substring(n,n+e.length);if(i.toLowerCase()==e){s.push({cd_pronuncia:d.cdPronuncia,cd_dicionario:d.cdDicionario,ds_expressao:d.dsExpressao,texto:i});var l=t.format(a,c);o=o.replace(new RegExp("\\b"+i+"\\b","g"),l),c++,r=o.toLowerCase()}n=r.search(new RegExp("\\b"+e+"\\b"))}})}for(var l=0;l<s.length;l++){var d=s[l],f=t.format(a,l),m=null,h=null,g=null;d.cd_dicionario?(h="openDictionary("+d.cd_dicionario+", '"+d.texto+"');",g="dictionary-link"):(h="openPronunciation('"+d.ds_expressao.trim()+"');",g="pronunciation-link"),m='<span class="'+g+'" ng-click="'+h+'">'+d.texto+"</span>",o=t.replaceAll(o,f,m)}return o}}angular.module("routines").service("stringService",e)}(),function(){function e(e,t){var n=this;n.showModal=function(n){var i=e.defer(),o=t.createWindow({scope:n,title:"Creating a new video",width:"550px",height:"300px",position:t.POSITION.CENTER,buttons:[t.BUTTON.OK,t.BUTTON.CANCEL],urlTemplate:"src/app/shared/item/new-video-item-modal/new-video-item-modal.view.html",modal:!0,listeners:{onshow:function(e){n.newVideoItemModal.kindOfVideo=0}}});return o.show().then(function(e){"ok"==e.button?i.resolve(n.newVideoItemModal):i.reject()}),i.promise}}angular.module("item").service("newVideoItemModalService",e)}(),function(){function e(e,t,n,i,o,r,a){var s=this;s.controller;var c=null;s.setController=function(e){s.controller=e},s.showModal=function(n){var i=e.defer();return t.createWindow({scope:n,title:"Pronunciation",width:"550px",height:"450px",position:t.POSITION.CENTER,buttons:[t.BUTTON.CLOSE],urlTemplate:"src/app/shared/pronunciation/pronunciation-modal/pronunciation-modal.view.html",modal:!0,listeners:{onshow:function(e){}}}).show().then(function(){a.loadedExpressions=r.cachedExpressions.concat(s.controller.gridPronunciationOptions.alldata),i.resolve(s.controller.gridPronunciationOptions.alldata)}),i.promise},s.getGridPronunciationOptions=function(){return{keyField:"cdPronuncia",rowHeight:"25px",data:i.loadedExpressions,hideHeaders:!0,columns:[{name:"dsExpressao",width:"80%"},{width:"10%",action:{mdIcon:"headset",tooltip:"Listen the selected expression",fn:function(e,t,n){o.listenExpression(e.dsExpressao)}}},{width:"10%",action:{mdIcon:"delete_forever",tooltip:"Remove a expression from pronunciation",fn:function(e,t,n){i.del(e.cdPronuncia).then(function(t){var n=function(t){for(var n=t.length-1;n>=0;n--)if(t[n].cdPronuncia==e.cdPronuncia){t.splice(n,1);break}};n(s.controller.gridPronunciationOptions.data),n(s.controller.gridPronunciationOptions.alldata),s.controller.gridPronunciationOptions.api.loadData(s.controller.gridPronunciationOptions.alldata)})}}}],listeners:{onafterload:function(e,t){c&&(t.api.selectRow(c),c=null)}}}},s.searchInputChange=function(){s.controller.searchState=n.SearchState.SEARCHING},s.searchInputKeydown=function(){13==event.keyCode&&(s.controller.searchState==n.SearchState.SEARCHING?s.searchButtonClick(s.controller):s.controller.searchState==n.SearchState.SEARCHED&&s.searchButtonAddClick())},s.showSearchButton=function(e){return"search"==e&&s.controller.searchState==n.SearchState.SEARCHING||"add"==e&&s.controller.searchState==n.SearchState.SEARCHED},s.searchButtonClick=function(){s.controller.searchState=n.SearchState.SEARCHED;var e=$(".pronunciation-modal .search-input");s.controller.gridPronunciationOptions.api.filter(e.val())},s.searchButtonAddClick=function(){s.controller.searchState=n.SearchState.ADDED;var e=$(".pronunciation-modal .search-input"),t=e.val();i.add(t,"").then(function(e){c=e.data.data[0];var t=function(e){for(var t=e.length,n=e.length-1;n>=0;n--)if(c.dsExpressao>e[n].dsExpressao){t=n;break}e.splice(t,0,c)};t(s.controller.gridPronunciationOptions.data),t(s.controller.gridPronunciationOptions.alldata),s.controller.gridPronunciationOptions.api.loadData(s.controller.gridPronunciationOptions.alldata),s.controller.searchState=n.SearchState.STOPPED})},s.showLoading=function(){return s.controller.searchState==n.SearchState.ADDED}}angular.module("pronunciation").service("pronunciationModalService",e)}(),function(){function e(e,t,n,i,o,r,a,s,c,l){var d=this;d.controller,d.setController=function(e){d.controller=e},d.selectExpression=function(e){d.controller.showDefinitionContent=!1,d.controller.expressions.length>0&&(d.controller.currentExpressionIndex=e,d.controller.currentExpression=d.controller.expressions[e],d.controller.currentExpression.t50dci?(d.controller.model.expression.dsExpressao=d.controller.currentExpression.t50dci.dsExpressao,d.controller.model.expression.type="Dictionary",d.controller.model.expression.resultType="menu"):(d.controller.model.expression.dsExpressao=d.controller.currentExpression.t51prn.dsExpressao,d.controller.model.expression.type="Pronuciation",d.controller.model.expression.resultType="volume_up"),d.controller.model.expression.definition="")},d.showResult=function(e){if(e.currentExpression.t50dci){event.ctrlKey&&r.listenExpression(e.currentExpression.t50dci.dsExpressao);var t=$(".spaced-revision-modal .definition-detail-content-content dictionary-definition-viewer"),n=angular.element(t),i=n.scope();i.$$childTail.ctrl.cdDicionario=e.currentExpression.t50dci.cdDicionario,i.$$phase||i.$apply(),d.controller.showDefinitionContent=!0}else angular.isDefined(e.currentExpression.t51prn.cdPronuncia)&&r.listenExpression(e.currentExpression.t51prn.dsExpressao)},d.markAsReviewed=function(e){return a.markAsReviewed(e).then(function(){s.ghost("Spaced Revision","Item marked as reviewed successfuly!")})},d.selectExpressions=function(){l.showModal(e.selectedCdItem).then(function(e){d.controller.expressions=t("filter")(e,function(e,t,n){return e.blMostrar})})},d.showModal=function(t,o){e.selectedCdItem=o,e.loading=!0,c.getExpressions(o,!0).then(function(t){e.loading=!1,s.createWindow({scope:e,title:"Spaced Revision",width:"900px",height:"600px",position:s.POSITION.CENTER,buttons:[s.BUTTON.CLOSE],urlTemplate:"src/app/shared/spaced-revision/spaced-revision-modal/spaced-revision-modal.view.html",modal:!0,listeners:{onshow:function(e){c.getItemInfo(o).then(function(r){d.controller.expressions=t,d.selectExpression(0),d.controller.element=$(e),d.controller.cdItem=o,d.controller.itemImage=n.format("{0}item/image/get?cd_item={1}&time={2}",i.SERVER_URL,o,(new Date).getMilliseconds()),d.controller.dsItem=r.dsItem,d.controller.dsBreadCrumbPath=r.dsBreadCrumbPath})}}}).show()})}}angular.module("app").service("spacedRevisionModalService",e)}(),function(){function e(e,t,n,i,o,r,a){var s=this;s.controller,s.expressions,s.setController=function(e){s.controller=e},s.showModal=function(t){var n=i.defer();return e.loading=!0,o.getExpressions(t,!1).then(function(i){e.loading=!1,s.expressions=i;var o=a.createWindow({scope:e,title:"Spaced Revision - Selecting Expressions",width:"750px",height:"600px",position:a.POSITION.CENTER,buttons:[a.BUTTON.OK,a.BUTTON.CANCEL],urlTemplate:"src/app/shared/spaced-revision/spaced-revision-select-expressions-modal/spaced-revision-select-expressions-modal.view.html",modal:!0,listeners:{onshow:function(e){}}});o.show().then(function(e){"ok"==e.button?r.updExpressions(t,s.controller.expressions).then(function(){n.resolve(s.controller.expressions)}):n.reject()})}),n.promise},s.getExpressions=function(){return s.expressions},s.filterExpressionsDicionary=function(e){return e.t50dci},s.filterExpressionsPronunciation=function(e){return e.t51prn}}angular.module("app").service("spacedRevisionSelectExpressionsModalService",e)}(),function(){function e(e,t,n,i){var o=this;o.controller,o.setController=function(e){o.controller=e},o.showModal=function(r,a){var s=e.defer();return n.createWindow({scope:r,title:"Dictionary - Editing",width:"400px",height:"200px",position:n.POSITION.CENTER,buttons:[n.BUTTON.OK],urlTemplate:"src/app/shared/dictionary/dictionary-modal/dictionary-modal-edit/dictionary-modal-edit.view.html",modal:!0,listeners:{onshow:function(e){var n=t(function(){o.controller&&(t.cancel(n),o.controller.model.dsExpression=a.dsExpressao,o.controller.model.dsTags=a.dsTags,$(e).keydown(function(){var t=event.which||event.keyCode;13==t&&"tagsEdit"==event.target.name&&e.close("ok")}))},100)}}}).show().then(function(e){"ok"==e.button&&(i.upd(a.cdDicionario,o.controller.model.dsExpression,o.controller.model.dsTags),s.resolve(o.controller.model))}),s.promise}}angular.module("app").service("dictionaryModalEditService",e)}(),function(){function e(e){var t=this;t.cdDicionario=null,t.controller=null,t.setController=function(e){t.controller=e};var n=function(e){var n=t.controller.element.find(".definition");if(n.html(""),e){var i=$(document.createElement("div"));i.html(e),n.append(i)}};t.refreshDefinition=function(i){t.controller.currentDefinition="",n(""),t.cdDicionario=i,i&&e.definitionGet(i).then(function(e){if(e.data.total>0){var i=e.data.data[0];t.controller.currentDefinition=i.txDefinicao,n(t.controller.currentDefinition)}})},t.definitionEditClick=function(){t.controller.currentDefinitionBeforeEditing=t.controller.currentDefinition,t.controller.editingDefinition=!0},t.definitionSaveClick=function(){e.definitionSet(t.cdDicionario,t.controller.currentDefinition).then(function(e){t.controller.editingDefinition=!1,n(t.controller.currentDefinition)})},t.definitionCancelClick=function(){t.controller.currentDefinition=t.controller.currentDefinitionBeforeEditing,t.controller.editingDefinition=!1}}angular.module("dictionary").service("dictionaryDefinitionViewerService",e)}(),function(){function e(e,t){e.setController(this),this.searchState=t.SearchState.STOPPED,this.searchValue="",this.gridDictionaryOptions=e.getGridDictionaryOptions(),this.searchInputChange=e.searchInputChange,this.searchInputKeydown=e.searchInputKeydown,this.searchButtonClick=e.searchButtonClick,this.searchButtonAddClick=e.searchButtonAddClick,this.showSearchButton=e.showSearchButton,this.showLoading=e.showLoading}angular.module("dictionary").controller("DictionaryModalController",e)}(),function(){function e(e){var t=this,n=function(e,t,n,i){var o=0,r=0;e instanceof HTMLImageElement?(o=e.naturalWidth,r=e.naturalHeight):(o=e.videoWidth,r=e.videoHeight);var a=document.createElement("canvas"),s=t,c=n,l=1;r>o?(l=s/o,c=l*r):(l=c/r,s=l*o),a.width=s,a.height=c;var d=a.getContext("2d");return d.drawImage(e,0,0,o,r,0,0,s,c),a.toDataURL("image/jpeg",i)};t.capturePosterFromVideo=function(){var e=$(".video-preview").get(0),t=n(e,150,150,.5);console.log(t)}}angular.module("item").controller("newVideoItemModalController",e)}(),function(){function e(e,t){e.setController(this),this.searchState=t.SearchState.STOPPED,this.searchValue="",this.gridPronunciationOptions=e.getGridPronunciationOptions(),this.searchInputChange=e.searchInputChange,this.searchInputKeydown=e.searchInputKeydown,this.searchButtonClick=e.searchButtonClick,this.searchButtonAddClick=e.searchButtonAddClick,this.showSearchButton=e.showSearchButton,this.showLoading=e.showLoading}angular.module("pronunciation").controller("pronunciationModalController",e)}(),function(){function e(e,t,n,i,o,r){var a=this;r.setController(a),a.showDefinitionContent=!1,a.learnedRate=60,a.expressions=[],a.currentExpression,a.currentExpressionIndex,a.model={expression:{}},a.model.navigatorStatus="",a.navigate=function(e){r.selectExpression(a.currentExpressionIndex+e)},a.navigateFirst=function(){r.selectExpression(0)},a.navigateLast=function(){r.selectExpression(a.expressions.length-1)},a.showResult=function(){r.showResult(a)},a.markAsReviewed=function(e){r.markAsReviewed(e)},a.selectExpressions=r.selectExpressions}angular.module("app").controller("SpacedRevisionController",e)}(),function(){function e(e){this.selectedExpressions={},e.setController(this),this.expressions=e.getExpressions(),this.filterExpressionsDicionary=e.filterExpressionsDicionary,this.filterExpressionsPronunciation=e.filterExpressionsPronunciation}angular.module("app").controller("SpacedRevisionSelectExpressionsModalController",e)}(),function(){function e(e){e.setController(this),this.model={}}angular.module("dictionary").controller("DictionaryModalEditController",e)}(),function(){function e(e,t){t.setController(this),this.currentDefinition=null,this.editingDefinition=!1,this.definitionEditClick=t.definitionEditClick,this.definitionSaveClick=t.definitionSaveClick,this.definitionCancelClick=t.definitionCancelClick,e.$watch("ctrl.cdDicionario",function(e,n){t.refreshDefinition(e)})}angular.module("dictionary").controller("dictionaryDefinitionViewerController",e)}(),function(){function e(){return{restrict:"E",scope:{},bindToController:{cdDicionario:"=?"},controller:"dictionaryDefinitionViewerController",controllerAs:"ctrl",templateUrl:"src/app/shared/dictionary/directives/dictionary-definition-viewer/dictionary-definition-viewer.view.html",link:function(e,t,n){e.ctrl.element=$(t)}}}angular.module("dictionary").directive("dictionaryDefinitionViewer",e)}(),function(){function e(e,t,n,i,o,r,a,s,c,l,d){var u=this,p=null;u.addCategoryClick=function(e,t){i.add(e,t).then(function(e){var n={state:"open",id:e.cdCategoria,text:e.dsCategoria,data:e};p.create_node(t,n,"last",function(e){p.deselect_all(),p.select_node(e)})})},u.editCategoryClick=function(e,t){i.rename(e,t.id,t.text).then(function(e){p.rename_node(t,e)})},u.delCategoryClick=function(e){i.del(e.id).then(function(t){var n=p.get_node(e.parent);p.delete_node([e]),p.select_node(n)})};var f=function(e){return"#"==e.currentCategoryNode.parent?e.currentCategoryNode.id:e.currentCategoryNode.parents[e.currentCategoryNode.parents.length-2]};u.addNewItemButtonClick=function(e,t,n){var i=f(e);r.add(t,i,e.currentCategoryNode.id).then(function(t){e.gridOptions.api.reload().then(function(n){var i=t.data[0],o=i.cdItem||i.t05itm.cdItem;e.gridOptions.api.findKey(o,{inLine:!0})})})};var m=function(e,t){e.currentCategoryNode=t.node,e.currentCategory=e.currentCategoryNode.id;
for(var n='<span class="categoryPathTitle">'+e.currentCategoryNode.text+"</span>",i=e.currentCategoryNode.parent;"#"!=i;){var o=t.instance.get_node(i);n=o.text+" / "+n;var i=o.parent}e.categoryPath=n};u.reloadDataGrid=function(e){e.currentCategoryNode&&("pageItems"==e.currentNavItem?e.gridOptions.url=o.SERVER_URL+"item/list?cd_categoria="+e.currentCategoryNode.id:"pageRevisions"==e.currentNavItem?e.gridOptions.url=o.SERVER_URL+"revision/list?pendente=true&days=5&cd_categoria="+e.currentCategoryNode.id:e.gridOptions.url=o.SERVER_URL+"item/favorite/get?cd_categoria="+e.currentCategoryNode.id,e.gridOptions.api.reload())},u.configureTreeView=function(e){$("#categoryTreeview").on("loaded.jstree",function(t,n){p=n.instance,e.currentCategory&&p.select_node(e.currentCategory)}).on("changed.jstree",function(t,n){n.node&&(m(e,n),u.reloadDataGrid(e))}).jstree({core:{check_callback:!0,data:{url:o.SERVER_URL+"category/category/tree/list",dataType:"json"}},plugins:["wholerow"]})},u.configureGridItems=function(i,u){i.gridOptions={hideHeaders:!0,colLines:!1,keyField:"cdItem",rowHeight:"100px",columns:[{header:"Item",name:"cdItem",width:"calc(100% - 96px)",renderer:function(e,t){var n=null,r=f(i);n=r==d.topParentNodeId?"/text":"/video";var s=new Date,c=s.getMilliseconds(),l=t.blFazerRevisao?"check_box":"check_box_outline_blank",u=t.blFazerRevisao?"selected":"",p=t.blFavorite?"star":"star_border",m=t.blFavorite?"selected":"",h='<div class="cell-template">\n    <img class="item-image"\n        src="{0}item/image/get?cd_item={1}&time={5}" \n    />\n    <div><a href="#{2}/{1}">{3}</a></div>\n    <div>{4}</div>\n    <md-icon class="material-icons revise {6}"> {7} </md-icon>\n    <md-icon class="material-icons favorite {8}"> {9} </md-icon>\n<div>';return a.format(h,o.SERVER_URL,t.cdItem,n,t.dsItem,"bl치 bl치 bl치 bl치",c,u,l,m,p)}},{width:"32px",action:{mdIcon:"restore",tooltip:"",fn:function(e,t,n){s.showModal(u,e.cdItem)}}},{width:"32px",action:{mdIcon:"edit",tooltip:"",fn:function(e,t,o){var r=$(o).closest(".ui-row"),a=r.find(".item-image"),s={description:e.dsItem,imgSrc:a.attr("src")},d=c.createWindowDescriptionMoreImage(s);d.show().then(function(t){if("ok"==t.button){var o=n.getDataURLImagemObjeto(t.data.imageEl.get(0),160,140,1);l.upd(e.cdItem,i.currentCategory,t.data.description,o).then(function(e){i.gridOptions.api.reload().then(function(n){a.attr("src",t.data.image);var o=e.data[0].cdItem;i.gridOptions.api.findKey(o,{inLine:!0})})})}})}}},{width:"32px",action:{mdIcon:"delete_forever",tooltip:"",fn:function(e,t,n){r.del(e.cdItem).then(function(){i.gridOptions.api.reload()})}}}],listeners:{onbeforeload:function(e,n){t.subTitle=""},onafterrepaintrow:function(t,n){e(function(){n.find(".material-icons.revise").click(function(e){var t=i.gridOptions.api.getSelectedRow();t.blFazerRevisao=!t.blFazerRevisao;var n=$(e.currentTarget);n.is(".selected")?(n.html("check_box_outline_blank"),n.removeClass("selected")):(n.html("check_box"),n.addClass("selected")),r.revision.set(t.cdItem,t.blFazerRevisao).then(function(e){c.ghost("Items","Item updated successfuly!")})}),n.find(".material-icons.favorite").click(function(e){var t=i.gridOptions.api.getSelectedRow();t.blFavorite=!t.blFavorite;var n=$(e.currentTarget);n.is(".selected")?(n.html("star_border"),n.removeClass("selected")):(n.html("star"),n.addClass("selected")),r.favorite.set(t.cdItem,t.blFavorite).then(function(e){c.ghost("Items","Item updated successfuly!")})})},500)},onselectionchange:function(e,n,i,o){t.subTitle=o.dsItem,u.$$phase||u.$apply()}}}}}angular.module("app").service("homeService",e)}(),function(){function e(e){function t(t){return e.requestWithPromise("text/list",{cd_item:t})}function n(t){return e.requestWithPromise("text/content/get",{cd_texto:t})}function i(t,n){var i={title:"Texts",message:"text updated successfully!"};return e.requestWithPromisePayLoad("text/content/set",{},{cd_texto:t,tx_conteudo:n},i)}return{list:t,getContent:n,setContent:i}}angular.module("text").factory("textDataService",e)}(),function(){function e(e,t,n){var i=this;i.topParentNodeId=275,i.setContent=function(e,i,o){var r=$(".text .text-content");e.content=o,e.formatedContent=t.addLinksDictionaryAndPronunciation(e.content),n.insertHtmlWithController(r,e.formatedContent,"textController",i)}}angular.module("text").service("textService",e)}(),function(){function e(e){function t(t,n,i,o){var r={title:"Videos",message:"Video added successfully!"};return e.requestWithPromisePayLoad("video/add",{},{cd_categoria:t,tp_video:n,id_video:i,ds_item:o},r)}function n(t){return e.requestWithPromise("video/get",{cd_item:t})}function i(t,n){var i={title:"Videos",message:"commentary updated successfully!"};return e.requestWithPromisePayLoad("video/commentary/set",{cd_video:t},{txCommentaries:n},i)}return{add:t,get:n,commentaries:{set:i}}}angular.module("video").service("videoDataService",e)}(),function(){function e(e,t,n,i,o,r,a,s,c,l,d,u,p){var f=this;f.topParentNodeId=276,f.controller=null,f.setController=function(e){f.controller=e};var m=function(e,t){for(var n=e.gridSubtitlesOptions.data,i=0;i<n.length;i++){var o=n[i];if(t>=o.nrStart&&t<=o.nrEnd){i!==e.gridSubtitlesOptions.api.getSelectedRowIndex()&&e.gridSubtitlesOptions.api.selectRow(i,!0,!1);break}}},h=!1;f.configElementVideo=function(e,t){var i=r.defer();return e.onPlayerReady=function(t){e.videoAPI=t,e.videoAPI.autoPlay=!1;var n=o(function(){angular.isDefined(e.currentTime)&&o.cancel(n)},1e3)},e.onUpdateTime=function(t,n){e.currentTime=1e3*t,e.totalTime=1e3*n,e.timeLeft=e.totalTime-e.currentTime,h||m(e,t)},a.get(t).then(function(t){var o=t.data.data[0];i.resolve(o);var r;r="YOUTUBE"===o.tpVideo?"https://www.youtube.com/watch?v="+o.idVideo:"https://googledrive.com/host/"+o.idVideo,e.videoConfig={autoPlay:!1,sources:[{src:n.trustAsResourceUrl(r),type:"video/mp4"}],theme:{url:"dist/videogular/videogular.css"},plugins:{controls:{autoHide:!0,autoHideTime:5e3}}}}),i.promise},f.configGridSubtitles=function(e,n){e.gridSubtitlesOptions={keyField:"cdItemSubtitle",rowHeight:"37px",url:s.SERVER_URL+"/subtitle/list?cd_item="+n,hideHeaders:!0,columns:[{name:"nrStart",width:"15%",align:"center",renderer:function(e,t){return c.doubleToStrTime(e)}},{name:"nrEnd",width:"15%",align:"center",renderer:function(e,t){return c.doubleToStrTime(e)}},{name:"dsTexto",width:"80%",renderer:function(t,n){var o=$("<div>"+c.addLinksDictionaryAndPronunciation(t)+"</div>");return i(o)(e.scope),o}}],listeners:{onselectionchange:function(n,i,o,r){h=!0;try{e.videoAPI.seekTime(r.nrStart)}finally{t(function(){h=!1},1500)}},onrowdblclick:function(e,t,n){f.editSubtitleButtonClick()}}}},f.configWYSIWYG=function(e,t){var n=function(){a.commentaries.set(e.t08vdo.cdVideo,e.t08vdo.txComentarios)},i=function(){a.get(t).then(function(t){e.t08vdo=t.data.data[0]})};e.options=p.getConfigWYSIWYG(n,i)},f.editSubtitleButtonClick=function(){u.edit(f.controller.scope,f.controller).then(function(e){f.controller.gridSubtitlesOptions.api.reload().then(function(){f.controller.gridSubtitlesOptions.api.findKey(e.cdItemSubtitle,{inLine:!0})})})},f.importSubtitleFromLyrics=function(){l.showModal(f.controller.cdItem).then(function(e){f.controller.gridSubtitlesOptions.api.loadData(e)})},f.importSubtitleFromSrtFile=function(){d.showModal(f.controller.cdItem).then(function(e){f.controller.gridSubtitlesOptions.api.loadData(e)})}}angular.module("video").service("videoService",e)}(),function(){function e(e){function t(t){return e.requestWithPromise("subtitle/list",{cd_item:t})}function n(t,n,i,o){var r={title:"Inserting",message:"Subtitle added successfully!"};return e.requestWithPromisePayLoad("subtitle/add",{},{cd_video:t,nr_start:n,nr_end:i,ds_texto:o},r)}function i(t,n,i,o){var r={title:"Updating",message:"Subtitle updated successfully!"};return e.requestWithPromisePayLoad("subtitle/upd",{},{cd_item_subtitle:t,nr_start:n,nr_end:i,ds_texto:o},r)}function o(t){var n={title:"Updating",message:"Subtitle updated successfully!"};return e.requestWithPromise("subtitle/incasecond",{cd_item_subtitle:t},n)}function r(t){var n={title:"Updating",message:"Subtitle updated successfully!"};return e.requestWithPromise("subtitle/decasecond",{cd_item_subtitle:t},n)}function a(t){var n={title:"Deleting",message:"Subtitle deleted successfully!"};return e.requestWithPromise("subtitle/del",{cd_item_subtitle:t},n,"Confirm deleting?")}return{list:t,add:n,upd:i,incASecond:o,decASecond:r,del:a}}angular.module("video").service("subtitleDataService",e)}(),function(){function e(e,t,n,i){var o=this;o.cdItem=null,o.controller=null,o.setController=function(e,t){o.controller=e,o.controller.cdItem=o.cdItem},o.showModal=function(r){o.cdItem=r;var a=t.defer(),s=i.createWindow({scope:e,title:"Importing Subtitle from a text (often lyrics of musics)",width:"550px",height:"500px",position:i.POSITION.CENTER,buttons:[i.BUTTON.OK,i.BUTTON.CANCEL],urlTemplate:"src/app/components/video/video-modal-import-subtitle-lyrics/video-modal-import-subtitle-lyrics.view.html",modal:!0,listeners:{onshow:function(e){}}});return s.show().then(function(e){if("ok"===e.button){var t={title:"Updating",message:"Item updated successfully!"},i=$(s).find("textarea"),r=i.val();n.requestWithPromisePayLoad("subtitle/importlyrics",{},{cdItem:o.cdItem,lyrics:r},t).then(function(e){a.resolve(e.data)})}}),a.promise}}angular.module("video").service("videoModalImportSubtitleLyricsService",e)}(),function(){function e(e,t,n,i,o){var r=this;r.cdItem=null,r.controller=null,r.setController=function(e,t){r.controller=e,r.controller.cdItem=r.cdItem,t.$watch("ctrl.strFile",function(e,t){r.controller.strFile=e})},r.showModal=function(a){r.cdItem=a;var s=e.defer(),c=o.createWindow({scope:n,title:"Importing Subtitle (.srt)",width:"600px",height:"230px",position:o.POSITION.CENTER,buttons:[o.BUTTON.OK,o.BUTTON.CANCEL],urlTemplate:"src/app/components/video/video-modal-import-subtitle-srt/video-modal-import-subtitle-srt.view.html",modal:!0,listeners:{onshow:function(e){}}});return c.show().then(function(e){if("ok"===e.button&&r.controller.strFile&&!r.controller.strFile.$error){var n=($(c).find("input[type=file]"),new FormData);n.append("cdItem",r.cdItem),n.append("file",r.controller.strFile),t.post(i.SERVER_URL+"subtitle/importsrt",n,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(e){o.ghost("Subtitles","Subtitles imported successfully!"),s.resolve(e.data)}).error(function(e){s.reject(e)})}}),s.promise}}angular.module("video").service("videoModalImportSubtitleSrtService",e)}(),function(){function e(e,t,n,i){var o=this,r={ADDING:1,EDITING:2},a=function(o,a,s){var c=e.defer();a.subtitleModalData={};var l=a.gridSubtitlesOptions.api.getSelectedRow();s===r.EDITING?(a.subtitleModalData.start=n.doubleToStrTime(l.nrStart),a.subtitleModalData.end=n.doubleToStrTime(l.nrEnd),a.subtitleModalData.text=l.dsTexto):l?(a.subtitleModalData.start=n.doubleToStrTime(l.nrStart+1),a.subtitleModalData.end=n.doubleToStrTime(l.nrStart+2)):(a.subtitleModalData.start=n.doubleToStrTime(1),a.subtitleModalData.end=n.doubleToStrTime(10));var d=t.createWindow({scope:o,title:"Subtitles",width:"450px",height:"230px",position:t.POSITION.CENTER,buttons:[t.BUTTON.OK,t.BUTTON.CANCEL],urlTemplate:"src/app/components/video/subtitle/modals/subtitle-modal.view.html",modal:!0,listeners:{onshow:function(e){}}});return d.show().then(function(e){if("ok"===e.button){a.subtitleModalData.start=n.strTimeToDouble(a.subtitleModalData.start),a.subtitleModalData.end=n.strTimeToDouble(a.subtitleModalData.end),console.log(a.subtitleModalData),s===r.EDITING?i.upd(l.cdItemSubtitle,a.subtitleModalData.start,a.subtitleModalData.end,a.subtitleModalData.text).then(function(e){c.resolve(e.data[0])}):i.add(a.t08vdo.cdVideo,a.subtitleModalData.start,a.subtitleModalData.end,a.subtitleModalData.text).then(function(e){c.resolve(e.data[0])})}else c.reject("")}),c.promise};o.add=function(e,t){return a(e,t,r.ADDING)},o.edit=function(e,t){return a(e,t,r.EDITING)}}angular.module("video").service("subtitleModalService",e)}(),function(){function e(e,t,n,i,o){var r=this;r.categoryPath=null,r.currentCategory=null,o.createHamburgerButton(["show-xs","hide-gt-xs"],o.SideEnum.LEFT),r.currentNavItem="pageItems",r.currentCategoryNode=null,$.jstree.defaults.core.themes.variant="large",r.addCategoryClick=function(){i.addCategoryClick(e,r.currentCategoryNode.id)},r.editCategoryClick=function(){i.editCategoryClick(e,r.currentCategoryNode)},r.delCategoryClick=function(){i.delCategoryClick(r.currentCategoryNode)},r.addNewItemButtonClick=function(t){i.addNewItemButtonClick(r,e,t)},i.configureTreeView(r,r.currentCategory||n.cdCategoria),i.configureGridItems(r,e),e.$watch("ctrl.currentNavItem",function(e,t){r.currentNavItem=e,e&&i.reloadDataGrid(r)})}angular.module("app").controller("homeController",e)}(),function(){function e(e,t,n,i,o,r,a,s,c,l,d,u,p,f){var m=this;m.editing=!1,m.params=n,m.texts=[],m.selectedIndex=-1,m.contentStored="",m.content="",m.formatedContent="",m.t05itm=null,m.t07txt=null,f.get(m.params.cdItem).then(function(e){m.t05itm=e.data.data[0],t.subTitle=m.t05itm.dsItem}),s.list(m.params.cdItem).then(function(e){m.texts=e.data.data,m.selectedIndex=0}),m.dictionaryModalClick=function(){o.showModal(t).then(function(t){c.setContent(m,e,m.content)})},m.pronunciationModalClick=function(){a.showModal(t).then(function(t){c.setContent(m,e,m.content)})},e.$watch("ctrl.selectedIndex",function(n,i){angular.isDefined(n)&&n!==i&&m.texts.length>0&&(t.loading=!0,m.t07txt=m.texts[n],s.getContent(m.t07txt.cdTexto).then(function(n){l.getAllExpressions().then(function(i){c.setContent(m,e,n.data.data[0].txConteudo),t.loading=!1})}))}),m.editClick=function(){m.contentStored=m.content,m.editing=!0},m.saveClick=function(){s.setContent(m.t07txt.cdTexto,m.content).then(function(t){c.setContent(m,e,t.data[0].txConteudo),m.editing=!1})},m.cancelClick=function(){m.content=m.contentStored,m.editing=!1},m.listenSelectedTextClick=function(){var e=window.getSelection();e&&r.listenExpression(e.toString().trim())},m.spacedRevisionClick=function(){p.showModal(e,m.params.cdItem)},e.openDictionary=function(e,n){i.openDictionaryDefinitionView(t,e,n)},e.openPronunciation=function(e){r.listenExpression(e)}}angular.module("text").controller("textController",e)}(),function(){function e(e,t,n,i,o,r,a,s,c,l,d,u,p,f){var m=this;r.setController(m),m.scope=e,e.name="videoController",e.params=n,m.t05itm=null,m.cdItem=e.params.cdItem,m.commentaries="",m.initialCommentaries="",o.get(e.params.cdItem).then(function(e){m.t05itm=e.data.data[0],t.subTitle=m.t05itm.dsItem}),r.configElementVideo(m,e.params.cdItem).then(function(e){m.t08vdo=e}),r.configGridSubtitles(m,e.params.cdItem),r.configWYSIWYG(m,e.params.cdItem),i.getAllExpressions().then(function(e){m.gridSubtitlesOptions.api.repaint()}),m.dictionaryModalClick=function(){p.showModal(t).then(function(e){m.gridSubtitlesOptions.api.repaint()})},m.pronunciationModalClick=function(){d.showModal(t).then(function(e){m.gridSubtitlesOptions.api.repaint()})},m.addSubtitleButtonClick=function(){a.add(e,m).then(function(e){m.gridSubtitlesOptions.api.reload().then(function(){m.gridSubtitlesOptions.api.findKey(e.cdItemSubtitle,{inLine:!0})})})},m.editSubtitleButtonClick=r.editSubtitleButtonClick,m.delSubtitleButtonClick=function(){var e=m.gridSubtitlesOptions.api.getSelectedRow();s.del(e.cdItemSubtitle).then(function(){m.gridSubtitlesOptions.api.reload()})};var h=function(e){t.loading=!0;var n=m.gridSubtitlesOptions.api.getSelectedRow(),i=n.cdItemSubtitle;n.nrStart=n.nrStart+e,n.nrEnd=n.nrEnd+e;var o;o=e>0?s.incASecond:s.decASecond,o(i,n.nrStart,n.nrEnd,n.dsTexto).then(function(e){t.loading=!1,c.ghost("Subtitle","Subtitle time is update successfully"),m.gridSubtitlesOptions.api.repaint(),m.gridSubtitlesOptions.api.findKey(i,{inLine:!0})})};m.decreaseOneSecondButtonClick=function(){h(-1)},m.incrementOneSecondButtonClick=function(){h(1)},m.listenButtonClick=function(){var e=m.gridSubtitlesOptions.api.getSelectedRow();l.listenExpression(e.dsTexto)},m.spacedRevisionClick=function(){f.showModal(e,m.cdItem)},e.openDictionary=function(e,n){u.openDictionaryDefinitionView(t,e,n)},e.openPronunciation=function(e){l.listenExpression(e)},m.importSubtitleFromLyrics=r.importSubtitleFromLyrics,m.importSubtitleFromSrtFile=r.importSubtitleFromSrtFile}angular.module("video").controller("videoController",e)}(),function(){function e(e){e.setController(this)}angular.module("video").controller("videoModalImportSubtitleLyricsController",e)}(),function(){function e(e,t){t.setController(this,e)}angular.module("video").controller("VideoModalImportSubtitleSrtController",e)}(),angular.module("app").config(function(e){e.when("/:cdCategoria?",{templateUrl:"src/app/components/home/home.view.html",controller:"homeController",controllerAs:"ctrl"}).when("/text/:cdItem",{templateUrl:"src/app/components/text/text.view.html",controller:"textController",controllerAs:"ctrl"}).when("/video/:cdItem",{templateUrl:"src/app/components/video/video.view.html",controller:"videoController",controllerAs:"ctrl"}).otherwise({redirectTo:"/"})}),angular.module("app").controller("AppCtrl",function(e,t,n,i,o){e.$route=n,e.$location=o,e.$routeParams=i,t.loading=!1});